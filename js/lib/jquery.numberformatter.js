/**
 * jquery.numberformatter - Formatting/Parsing Numbers in jQuery
 * 
 * Written by
 * Michael Abernethy (mike@abernethysoft.com),
 * Andrew Parry (aparry0@gmail.com)
 *
 * Dual licensed under the MIT (MIT-LICENSE.txt)
 * and GPL (GPL-LICENSE.txt) licenses.
 **/
(function(f){function v(b,a,c){this.dec=b;this.group=a;this.neg=c}function s(b,a){if(0==q.size())for(var c=0;c<u.length;c++)for(var d=u[c],e=0;e<d.length;e++)q.put(d[e],c);c=".";d=",";!1==a&&(-1!=b.indexOf("_")?b=b.split("_")[1].toLowerCase():-1!=b.indexOf("-")&&(b=b.split("-")[1].toLowerCase()));if(e=q.get(b))if(e=w[e])c=e[0],d=e[1];return new v(c,d,"-")}var q=new Hashtable,w=[[".",","],[",","."],[","," "],[".","'"]],u=["ae au ca cn eg gb hk il in jp sk th tw us".split(" "),"at br de dk es gr it nl pt tr vn".split(" "),"bg cz fi fr no pl ru se".split(" "),["ch"]];f.fn.formatNumber=function(b,a,c){return this.each(function(){null==a&&(a=!0);null==c&&(c=!0);var d;d=f(this).is(":input")?new String(f(this).val()):new String(f(this).text());d=f.formatNumber(d,b);a&&(f(this).is(":input")?f(this).val(d):f(this).text(d));if(c)return d})};f.formatNumber=function(b,a){a=f.extend({},f.fn.formatNumber.defaults,a);s(a.locale.toLowerCase(),a.isFullLocale);for(var c="",d=!1,e=0;e<a.format.length;e++)if(-1=="0#-,.".indexOf(a.format.charAt(e)))c+=a.format.charAt(e);else if(0==e&&"-"==a.format.charAt(e))d=!0;else break;for(var h="",e=a.format.length-1;0<=e;e--)if(-1=="0#-,.".indexOf(a.format.charAt(e)))h=a.format.charAt(e)+h;else break;a.format=a.format.substring(c.length);a.format=a.format.substring(0,a.format.length-h.length);e=new Number(b);return f._formatNumber(e,a,h,c,d)};f._formatNumber=function(b,a,c,d,e){a=f.extend({},f.fn.formatNumber.defaults,a);var h=s(a.locale.toLowerCase(),a.isFullLocale),p=h.dec,q=h.group,h=h.neg;null!=a.overrideGroupSep&&(q=a.overrideGroupSep);null!=a.overrideDecSep&&(p=a.overrideDecSep);null!=a.overrideNegSign&&(h=a.overrideNegSign);var n=!1;if(isNaN(b))if(!0==a.nanForceZero)b=0,n=!0;else return"";if(!0==a.isPercentage||a.autoDetectPercentage&&"%"==c.charAt(c.length-1))b*=100;var m="";if(-1<a.format.indexOf(".")){var k=p,l=a.format.substring(a.format.lastIndexOf(".")+1);!0==a.round?b=new Number(b.toFixed(l.length)):(b=b.toString(),0<b.lastIndexOf(".")&&(b=b.substring(0,b.lastIndexOf(".")+l.length+1)),b=new Number(b));var g=new Number(b.toString().substring(b.toString().indexOf(".")));decimalString=new String(g.toFixed(l.length));decimalString=decimalString.substring(decimalString.lastIndexOf(".")+1);for(g=0;g<l.length;g++)if("#"==l.charAt(g)&&"0"!=decimalString.charAt(g))k+=decimalString.charAt(g);else if("#"==l.charAt(g)&&"0"==decimalString.charAt(g))if(decimalString.substring(g).match("[1-9]"))k+=decimalString.charAt(g);else break;else"0"==l.charAt(g)&&(k+=decimalString.charAt(g));m+=k}else b=Math.round(b);g=Math.floor(b);0>b&&(g=Math.ceil(b));k="";k=-1==a.format.indexOf(".")?a.format:a.format.substring(0,a.format.indexOf("."));l="";if(0!=g||"#"!=k.substr(k.length-1)||n){var n=new String(Math.abs(g)),r=9999;-1!=k.lastIndexOf(",")&&(r=k.length-k.lastIndexOf(",")-1);for(var t=0,g=n.length-1;-1<g;g--)l=n.charAt(g)+l,t++,t==r&&0!=g&&(l=q+l,t=0);if(k.length>l.length&&(n=k.indexOf("0"),-1!=n))for(n=k.length-n,g=k.length-l.length-1;l.length<n;)r=k.charAt(g),","==r&&(r=q),l=r+l,g--}l||-1===k.indexOf("0",k.length-1)||(l="0");m=l+m;0>b&&e&&0<d.length?d=h+d:0>b&&(m=h+m);a.decimalSeparatorAlwaysShown||m.lastIndexOf(p)==m.length-1&&(m=m.substring(0,m.length-1));return d+m+c};f.fn.parseNumber=function(b,a,c){null==a&&(a=!0);null==c&&(c=!0);var d;d=f(this).is(":input")?new String(f(this).val()):new String(f(this).text());if(b=f.parseNumber(d,b))if(a&&(f(this).is(":input")?f(this).val(b.toString()):f(this).text(b.toString())),c)return b};f.parseNumber=function(b,a){a=f.extend({},f.fn.parseNumber.defaults,a);var c=s(a.locale.toLowerCase(),a.isFullLocale),d=c.dec,e=c.group,h=c.neg;null!=a.overrideGroupSep&&(e=a.overrideGroupSep);null!=a.overrideDecSep&&(d=a.overrideDecSep);null!=a.overrideNegSign&&(h=a.overrideNegSign);for(var c=".-",p=a.strict;-1<b.indexOf(e);)b=b.replace(e,"");b=b.replace(d,".").replace(h,"-");d="";e=!1;if(!0==a.isPercentage||a.autoDetectPercentage&&"%"==b.charAt(b.length-1))e=!0;for(h=0;h<b.length;h++)if(-1<"1234567890".indexOf(b.charAt(h)))d+=b.charAt(h);else if(-1<c.indexOf(b.charAt(h)))d+=b.charAt(h),c=c.replace(b.charAt(h),"");else if(a.allowPostfix)break;else if(p){d="NaN";break}c=new Number(d);e&&(c/=100,p=d.indexOf("."),c=-1!=p?c.toFixed(d.length-p-1+2):c.toFixed(2));return c};f.fn.parseNumber.defaults={locale:"us",decimalSeparatorAlwaysShown:!1,isPercentage:!1,autoDetectPercentage:!0,isFullLocale:!1,strict:!1,overrideGroupSep:null,overrideDecSep:null,overrideNegSign:null,allowPostfix:!1};f.fn.formatNumber.defaults={format:"#,###.00",locale:"us",decimalSeparatorAlwaysShown:!1,nanForceZero:!0,round:!0,isFullLocale:!1,overrideGroupSep:null,overrideDecSep:null,overrideNegSign:null,isPercentage:!1,autoDetectPercentage:!0};Number.prototype.toFixed=function(b){return f._roundNumber(this,b)};f._roundNumber=function(b,a){var c=Math.pow(10,a||0),c=String(Math.round(b*c)/c);if(0<a){var d=c.indexOf(".");-1==d?(c+=".",d=0):d=c.length-(d+1);for(;d<a;)c+="0",d++}return c}})(jQuery);